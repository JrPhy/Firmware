GPIO(General Purpose Input/Output)是一種泛用型的輸入輸出裝置，每個晶片會有不同的 GPIO 端口。除了單純的輸入輸出外，還可以組合成常見的通訊協定，如 I2C, SPI, UART...... 等。內部會連接電子元件，如電容、電阻與電晶體來保護整個系統。在 STM32 中分別支援四種輸入與四種輸出模式\
![image](https://wiki.st.com/stm32mcu/nsfr_img_auth.php/thumb/0/04/Package_MCU_blue.png/225px-Package_MCU_blue.png)
![image](https://github.com/JrPhy/Firmware/blob/main/pic/Basic_structure_of_a_standard_IO_port_bit.png.png)\
上圖中 VDD 為工作電壓，VSS 為接地

## 1. 輸入模式
當電流從外部流入 IC 稱為輸入，有上拉、下拉、浮空跟模擬，比較常用的是前面兩種。對應上圖的 input driver，也就是上方的虛線框。
#### 1. 浮空輸入
就是讓外部電流不經過 TTL 且兩電阻也斷路，此時電流會直接流入 IC，這種狀況會有較多的不穩定，通常不用
#### 2. 模擬輸入
就是浮空輸入的電流經過 TTL，會將類比訊號轉為數位訊號
#### 3. 上拉輸入
在上端的輸入端加入一個電阻，導通時會**提供**一個微小的電流，會讓輸入的電壓稍微提高，所以稱為**上拉**，其電阻生為上拉電阻。
#### 4. 下拉輸入
與上拉相反，在上端的輸出端加入一個電阻，導通時會**流失**一個微小的電流，會讓輸入的電壓稍微降低，所以稱為**下拉**，其電阻生為下拉電阻。

## 1. 輸出模式
上圖為一標準 I/O 端口，看到下方的 Output driver 虛線框框，裡面有三種狀態，分別是 Push-pull, Open-drain or disable。VDD 與 VSS 為中間串接了 P/N MOS。兩個 MOS 會組成四種狀態如下表，O 代表輸出

| O | 高電位 | 低電位 | 高阻抗 | 短路 |
| --- | --- | --- | --- | --- |
| P | 打開 | 關閉 | 關閉 | 打開 |
| N | 關閉 | 打開 | 關閉 | 打開 |

#### 1. Push-Pull (推挽輸出)
當兩個 MOS 都是打開時，電流會直接從 VDD 到 VSS，也就是直接短路燒毀，所以只剩前面三種狀態。而當 VDD 為開 VSS 為閉，那麼電流從 IC 往外流出去，稱為 Push，反過來則稱為 Pull。此種輸出的電壓由 VDD 決定。

#### 2. Open-drain (開漏輸出)
這時接 VDD 的 MOS 都是關閉的，電流就只會流入 IC，因為怕流入的電流過高燒壞 IC，一般會搭配一個上拉電阻來降低流入 IC 的電流。電阻大電流就小，驅動能力就弱，但是漏電流也小，電阻小的話則相反，需要計算後才能得到一個較佳的電阻值。此輸出通常用於不同電壓的場景，開漏輸出可以讓多顆 IC 同時接到外部的訊號，只需要將兩顆 IC 並聯即可達到此功能。

#### 3. 復用推挽輸出
需要用到線 AND，如 IIC
#### 4. 復用開漏輸出
用於電壓快速變換，如 UART，PWM。
